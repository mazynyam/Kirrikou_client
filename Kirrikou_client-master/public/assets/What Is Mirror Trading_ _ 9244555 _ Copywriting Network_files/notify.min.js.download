!function(){var s={endpoint:"https://notify.explode.work",version:"1.3.11",later_ttl:864e5,title_msg:["Receive Updates","Get Updates","Recieve Notifications"],tagline_msg:["Agree to receive an update as they happen","Get updates to your device"],later_msg:["Ask Later","Maybe later","No thanks"],accept_msg:["Ok, Notify me!","I agree","I accept","Keep upto date","Let me know more"],delay:null,user:null,popup:null,greeting:null,status:null,randomArray:function(e){return e[Math.floor(Math.random()*e.length)]},getTitleMsg:function(){var e=s.popup;return e&&e.title?e.title:s.randomArray(s.title_msg)},getTaglineMsg:function(){var e=s.popup;return e&&e.tagline?e.tagline:s.randomArray(s.tagline_msg)},getLaterMsg:function(){var e=s.popup;return e&&e.later?e.later:s.randomArray(s.later_msg)},getAcceptMsg:function(){var e=s.popup;return e&&e.accept?e.accept:s.randomArray(s.accept_msg)},popupContainer:function(){return document.getElementById("notify-popup")},popupRemove:function(){var e;s.popup&&((e=s.popupContainer()).classList.remove("show-popup"),window.setTimeout(function(){e.remove()},200))},popupEvents:function(){var e=this.popupContainer(),t=e.querySelector(".notify-button-accept"),n=e.querySelector(".notify-button-later");t.addEventListener("click",function(){s.subscribe()},!1),n.addEventListener("click",function(){e.classList.remove("show-popup"),s.requestLater()},!1)},requestLater:function(){var e=s.later_ttl+(new Date).getTime();localStorage.setItem("show-popup",e.toString())},urlBase64ToUint8Array:function(e){for(var e=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=window.atob(e),n=new Uint8Array(t.length),o=0;o<t.length;++o)n[o]=t.charCodeAt(o);return n},unsubscribe:function(){navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(t){t&&t.unsubscribe().then(function(e){if(e)return localStorage.removeItem("show-popup"),fetch(s.endpoint+"/api/v1/unsubscribe",{method:"POST",body:JSON.stringify({endpoint:t.endpoint})})}).catch(function(e){console.error("Error on Unsubscribe",e)}).finally(function(){s.status="default"})})})},subscribe:function(){navigator.serviceWorker.ready.then(function(e){var t,n;s.popup&&(t=(n=s.popupContainer()).querySelector(".notify-button-accept"),n=n.querySelector(".notify-button-later"),t.disabled=!0,t.style.opacity=.5,n.disabled=!0,n.style.opacity=.5),e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:s.urlBase64ToUint8Array("BKFHEoe17TXNR5S_atkCE47iKpcFFAALX4wKfvFdhfAp1FA7h7KkUafHVrHfT0Iq4VcHi6vIHwKcGm_CmDQinC8")}).then(function(e){e=JSON.parse(JSON.stringify(e)),e={domain:window.location.hostname,endpoint:e.endpoint,keys:e.keys};return s.user&&Object.assign(e,{user:s.user}),s.greeting&&Object.assign(e,{greeting:s.greeting}),fetch(s.endpoint+"/api/v1/subscribe",{method:"POST",body:JSON.stringify(e)})}).catch(function(e){"denied"===Notification.permission?console.warn("Permission for Notifications was denied"):(s.requestLater(),console.warn("Unable to subscribe to push.",e))}).finally(function(){s.status=Notification.permission,s.popupRemove()})}).catch(function(e){console.error("Error on Registration",e)})},initialiseState:function(){return s.status=Notification.permission,window.Notify={status:function(){return s.status},unsubscribe:s.unsubscribe,subscribe:s.subscribe},"showNotification"in ServiceWorkerRegistration.prototype?"denied"===Notification.permission?(s.status="denied",void console.warn("The user has blocked notifications.")):"PushManager"in window?void navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(e){e?s.popup&&s.popupRemove():(e=isFinite(s.delay)?s.delay:3e3,setTimeout(function(){var e=(new Date).getTime();localStorage.getItem("show-popup")<e&&(s.popup?(s.popupContainer().hidden=!1,s.popupContainer().classList.add("show-popup"),s.popupEvents(),localStorage.removeItem("show-popup")):s.subscribe())},e))}).catch(function(e){console.error("Error during getSubscription()",e)})}):(s.status="unsupported",void console.warn("Push messaging isn't supported.")):(s.status="unsupported",void console.warn("Notifications aren't supported."))},init:function(e){var t,n,o,i,r,a;"Notify"in window&&window.Notify.length&&((a=window.Notify.shift()).user&&(s.user=a.user),a.popup&&(s.popup=a.popup),a.greeting&&(s.greeting=a.greeting),void 0!==a.delay&&(s.delay=a.delay)),s.popup&&((t=document.createElement("div")).classList.add("notify-popup"),t.id="notify-popup",t.hidden=!0,(n=document.createElement("h5")).classList.add("notify-title"),n.textContent=s.getTitleMsg(),(o=document.createElement("p")).classList.add("notify-tagline"),o.textContent=s.getTaglineMsg(),(i=document.createElement("div")).classList.add("notify-button"),(r=document.createElement("button")).classList.add("notify-button-later"),r.type="button",r.textContent=s.getLaterMsg(),(a=document.createElement("button")).classList.add("notify-button-accept"),a.type="button",a.textContent=s.getAcceptMsg(),i.appendChild(r),i.appendChild(a),t.appendChild(n),t.appendChild(o),t.appendChild(i),document.body.appendChild(t)),e()}};window.addEventListener("load",function(){s.init(function(){"serviceWorker"in navigator?navigator.serviceWorker.register("/notify-sw.min.js").then(s.initialiseState):(console.warn("Service workers aren't supported in this browser."),s.status="outdated")})})}();